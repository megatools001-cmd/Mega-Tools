<!DOCTYPE html>
<html lang="en">
<head>
              <link rel="icon" href="favicon-16x16.png" type="image/x-icon">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF Editor with Resizable Images</title>
<style>
  body { font-family: Arial, sans-serif; background: #f8fbff; margin: 0; padding: 0; text-align: center; }
  header { background: #007bff; color: white; padding: 15px; font-size: 1.5rem; font-weight: bold; }
  .toolbar { margin: 10px 0; }
  input, select, button { margin: 5px; padding: 8px; font-size: 1rem; }
  #pdfContainer { border: 2px solid #007bff; width: 90%; max-width: 900px; margin: 20px auto; position: relative; overflow: auto; background: #fff; }
  canvas { display: block; margin: auto; border: 1px solid #ccc; }
  .text-box, .image-box { position: absolute; cursor: move; border: 1px dashed #007bff; background: rgba(255,255,255,0.7); }
  .text-box { padding: 2px 4px; font-size:16px; }
  .image-box img { display: block; }
  .size-inputs { margin-top:5px; }
</style>
</head>
<body>

<header>PDF Editor with Resizable Images</header>

<div class="toolbar">
  <input type="file" id="pdfUpload" accept="application/pdf">
  <input type="text" id="textInput" placeholder="Enter text">
  <select id="fontSize">
    <option value="14">14</option><option value="18">18</option><option value="24">24</option><option value="30">30</option>
  </select>
  <input type="color" id="textColor" value="#000000">
  <button onclick="addTextBox()">Add Text</button><br>

  <input type="file" id="imageUpload" accept="image/*">
  Width: <input type="number" id="imgWidth" value="100" style="width:60px;">
  Height: <input type="number" id="imgHeight" value="100" style="width:60px;">
  <button onclick="addImage()">Add Image</button><br>

  <button onclick="downloadPDF()">Download PDF</button>
</div>

<div id="pdfContainer"></div>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>

<script>
let pdfDoc = null;
let scale = 1.5;
let textBoxes = [];
let imageBoxes = [];
const pdfContainer = document.getElementById('pdfContainer');

document.getElementById('pdfUpload').addEventListener('change', async function() {
  const file = this.files[0];
  if (!file) return;
  const fileReader = new FileReader();
  fileReader.onload = async function() {
    const typedarray = new Uint8Array(this.result);
    pdfDoc = await pdfjsLib.getDocument(typedarray).promise;
    pdfContainer.innerHTML = '';
    for(let i=1; i<=pdfDoc.numPages; i++){
      const page = await pdfDoc.getPage(i);
      const viewport = page.getViewport({scale: scale});
      const canvas = document.createElement('canvas');
      canvas.width = viewport.width;
      canvas.height = viewport.height;
      pdfContainer.appendChild(canvas);

      const renderContext = { canvasContext: canvas.getContext('2d'), viewport: viewport };
      await page.render(renderContext).promise;
    }
  }
  fileReader.readAsArrayBuffer(file);
});

function addTextBox() {
  const text = document.getElementById('textInput').value;
  const fontSize = document.getElementById('fontSize').value;
  const color = document.getElementById('textColor').value;
  if (!text) return alert('Enter some text!');
  const div = document.createElement('div');
  div.className = 'text-box';
  div.contentEditable = true;
  div.style.fontSize = fontSize + 'px';
  div.style.color = color;
  div.style.left = '50px';
  div.style.top = '50px';
  div.innerText = text;
  pdfContainer.appendChild(div);
  makeDraggable(div);
  textBoxes.push(div);
}

function addImage() {
  const file = document.getElementById('imageUpload').files[0];
  const width = parseInt(document.getElementById('imgWidth').value);
  const height = parseInt(document.getElementById('imgHeight').value);
  if (!file) return alert('Select an image first!');
  const reader = new FileReader();
  reader.onload = function(e) {
    const div = document.createElement('div');
    div.className = 'image-box';
    div.style.left = '50px';
    div.style.top = '50px';
    const img = document.createElement('img');
    img.src = e.target.result;
    img.width = width;
    img.height = height;
    div.appendChild(img);
    pdfContainer.appendChild(div);
    makeDraggable(div);
    imageBoxes.push(div);
  }
  reader.readAsDataURL(file);
}

function makeDraggable(el) {
  let offsetX, offsetY, isDown = false;
  el.addEventListener('mousedown', function(e) {
    isDown = true;
    offsetX = e.clientX - el.offsetLeft;
    offsetY = e.clientY - el.offsetTop;
  });
  document.addEventListener('mousemove', function(e) {
    if(!isDown) return;
    el.style.left = (e.clientX - offsetX) + 'px';
    el.style.top = (e.clientY - offsetY) + 'px';
  });
  document.addEventListener('mouseup', function() {
    isDown = false;
  });
}

async function downloadPDF() {
  if (!pdfDoc) return alert('Upload a PDF first!');
  const origPdfBytes = await document.getElementById('pdfUpload').files[0].arrayBuffer();
  const newPdf = await PDFLib.PDFDocument.create();
  const origPdf = await PDFLib.PDFDocument.load(origPdfBytes);
  const pages = await newPdf.copyPages(origPdf, origPdf.getPageIndices());
  pages.forEach(page => newPdf.addPage(page));

  const page = newPdf.getPage(0); // Single-page edits for simplicity
  const font = await newPdf.embedFont(PDFLib.StandardFonts.Helvetica);

  textBoxes.forEach(div => {
    const { left, top } = div.getBoundingClientRect();
    const pdfHeight = page.getHeight();
    page.drawText(div.innerText, {
      x: left / scale,
      y: pdfHeight - (top / scale) - parseInt(div.style.fontSize),
      size: parseInt(div.style.fontSize),
      font: font,
      color: PDFLib.rgb(parseInt(div.style.color.slice(1,3),16)/255,
                        parseInt(div.style.color.slice(3,5),16)/255,
                        parseInt(div.style.color.slice(5,7),16)/255)
    });
  });

  for(let div of imageBoxes){
    const imgEl = div.querySelector('img');
    const imgBytes = await fetch(imgEl.src).then(r=>r.arrayBuffer());
    const imgPdf = await newPdf.embedPng(imgBytes);
    const { left, top } = div.getBoundingClientRect();
    const pdfHeight = page.getHeight();
    page.drawImage(imgPdf, {
      x: left / scale,
      y: pdfHeight - (top / scale) - imgEl.height,
      width: imgEl.width,
      height: imgEl.height
    });
  }

  const finalPdfBytes = await newPdf.save();
  const blob = new Blob([finalPdfBytes], { type: 'application/pdf' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'edited.pdf';
  link.click();
}
</script>
<script type='text/javascript' src='//pl27634807.revenuecpmgate.com/f5/d7/d7/f5d7d7682ff40e3082d0f54f6d462990.js'></script>
</body>
</html>
